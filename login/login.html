<!doctype html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<meta content="yes" name="apple-mobile-web-app-capable">
        <meta content="yes" name="apple-touch-fullscreen">
        <meta content="telephone=no,email=no" name="format-detection">
        <script type="text/javascript" src="../js/zoom/flexible.js" ></script>
        <script type="text/javascript" src="../js/zoom/flexible_css.js" ></script>
		<link href="../css/mui.min.css" rel="stylesheet" />
		<style>			
			body,html{
        		background-color: #FBD940 !important;
        		height: 100% !important;
				margin: 1px 0 0 0;
        	}
			.mui-icon{
				color: #000000;
			}
			a:hover{
				text-decoration: none;
			}
			.mui-bar-nav{
				box-shadow: none;
				-webkit-box-shadow: none;
			}
			.mui-bar{
				box-shadow: none;
				-webkit-box-shadow: none;
				background: #FBD940;
			}
			.mui-content>.mui-table-view:first-child{
				margin-top: 0;
			}
			.header-title{
				float: right;
				font-size:0.416666rem;
				margin-top: 0.42777rem;
			}
			
			.content-img{
				width: 3.833333rem;
				height: 3.916666rem;
				margin-top: 2.944444rem;
				margin-left: 3.069444rem;
			}
			
			.mui-content{
				padding-top: 0 !important;
				background: #FBD940;
				height: 100% !important;
			}
			
			.mui-input-group .mui-input-row{
				height: 1.236111rem;
			}
			
			.input-icon{
				width: 0.430555rem;
			}
			
			.mui-input-row label{
				width: 10% !important;
			}
			
			.mui-input-row input{
				width: 85% !important;
			}
			
			.mui-input-clear{
				height: 1.236111rem !important;
				padding-left: 0.375rem !important;
			}
			
			.mui-input-group{
				margin: 0 1.277777rem;
				border-radius:15px;
				margin-top: -12px;
			}
			
			.mui-btn{
				margin:0 1.277777rem;
				margin-top: 0.736111rem;
				width: 75%;
				border-radius:15px;
				color: #a3a3a3 !important;
				background-color: #535353;
				border: none;
			}
			
			.btn-register{
				margin-top:1.361111rem;
				text-align: center;
				font-size: 0.527777rem;
				color: #814203;
				font-weight: 600;
				font-family: "微软雅黑";
			}
		</style>
	</head>

	<body>
		<header class="mui-bar mui-bar-nav">
			<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
			<h1 id="btn_loose" class="header-title">忘记密码</h1>
		</header>
		<div class="mui-content">
			<img class="content-img" src="../imgs/login/bigtree.png" />
			<form class="mui-input-group">
			    <div class="mui-input-row">
			        <label><img class="input-icon" src="../imgs/login/phono.png"/></label>
			        <input id="login_nickname" type="text" class="mui-input-clear" placeholder="账号">
			    </div>
			    <div class="mui-input-row">
			        <label><img class="input-icon" src="../imgs/login/code.png"/></label>
			        <input id="login_password" type="text" class="mui-input-clear" placeholder="8-20位的数字或英文">
			    </div>
			</form>
			<button id='btn_login' type="button" class="mui-btn mui-btn-block">登录</button>	
			<div id="btn_tourist" class="btn-register">游客登录</div>
			<div id="btn_register" class="btn-register">立即注册</div>
		</div>
		<script src="../js/mui.min.js"></script>
		<script type="text/javascript">
			mui.init()
			//登录
			var login_nickname = document.getElementById("login_nickname");
			var login_password = document.getElementById("login_password");
			var btn_login = document.getElementById("btn_login");
			btn_login.addEventListener('tap',function(){
				mui.ajax('http://139.219.189.127:5000/api/login', {
					data: {
						username:login_nickname.value,
						password:login_password.value
					},
					dataType: 'json', //服务器返回json格式数据
					type: 'post', //HTTP请求类型
					timeout: 10000, //超时时间设置为10秒；
					headers: { 'Content-Type': 'application/json' },
					success: function(data) {
						var data = JSON.stringify(data);
						var dataobj = eval("(" + data + ")");
						
						if(dataobj.success ==true){
							var token = dataobj.token;							
							localStorage.setItem('name_token',token);
							mui.openWindow({
									url: '../object/main.html',
									id: 'main.html'
								});
						}else{
							//TODO 获取数据失败
						}
					},
					error: function(xhr, type, errorThrown) {
						//异常处理；
						mui.toast('登录失败，请稍后再试！');
						console.log(type);
					}
				});
			});
			//注册跳转
			var btn_register = document.getElementById("btn_register");
			btn_register.addEventListener('tap',function(){
				mui.openWindow({
			    url: 'information.html', 
			    id:'information.html'
			  });
			});
			
			//忘记密码跳转
			var btn_loose = document.getElementById("btn_loose");
			btn_loose.addEventListener('tap',function(){
				mui.openWindow({
			    url: 'register.html', 
			    id:'register.html'
			  });
			});
			
			//游客登录跳转
			var btn_tourist = document.getElementById("btn_tourist");
			btn_tourist.addEventListener('tap',function(){
				mui.openWindow({
			    url: '../object/main.html', 
			    id:'../object/main.html'
			  });
			});
		</script>
	</body>

</html>