<!doctype html>
<html lang="en" class="feedback">

	<head>
		<meta charset="UTF-8">
		<title></title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<meta content="yes" name="apple-mobile-web-app-capable">
		<meta content="yes" name="apple-touch-fullscreen">
		<meta content="telephone=no,email=no" name="format-detection">
		<script type="text/javascript" src="../js/zoom/flexible.js"></script>
		<script type="text/javascript" src="../js/zoom/flexible_css.js"></script>
		<link href="../css/mui.min.css" rel="stylesheet" />
		<link rel="stylesheet" type="text/css" href="../css/feedback.css" />
		<link rel="stylesheet" href="../css/imageviewer.css" />
		<link rel="stylesheet" href="../css/headerStyle.css" />
		<style>
			html,
			body {
				background-color: white;
				overflow: hidden;
			}
			
			input::-ms-clear {
				display: none;
			}
			
			.mui-content {
				background-color: white;
			}
			
			.btn-box {
				width: 10rem;
				position: relative;
			}
			
			.btn-return {
				position: absolute;
				padding: 5px 20px;
				border: 1px solid white;
				border-radius: 10px;
				background-color: white;
				top: 5px;
				font-size: 0.555555rem;
				color: #272727;
			}
			
			.btn-send {
				position: absolute;
				padding: 5px 20px;
				border: 1px solid white;
				border-radius: 10px;
				background-color: white;
				top: 5px;
				right: 0.555555rem;
				font-size: 0.555555rem;
				color: #272727;
			}
			
			.mui-bar-nav {
				box-shadow: none;
				background-color: #fbd940;
			}
			
			.mui-input-row {
				border: none;
			}
			
			#textarea {
				border: none;
			}
			
			#contact {
				border-radius: 0px;
				margin: 0;
				height: 44px;
				width: 40%;
				background-color: #FFFFFF;
			}
			
			.nav-footer {
				background-color: rgba(239, 239, 244, 1) !important;
				height: 44px;
				margin: 0 !important;
				padding: 0 !important;
				position: fixed !important;
				bottom: 0;
				width: 100%;
				display: flex;
				border-top: 1px solid #CCCCCC;
			}
			
			.function_btn {
				width: 60%;
				display: inline-flex;
				justify-content: space-around;
				background: #FFFFFF;
			}
			
			.function_btn img {
				margin-top: 9px;
				height: 30px !important;
			}
			
			.mui-input-row .mui-input-clear~.mui-icon-clear,
			.mui-input-row .mui-input-password~.mui-icon-eye,
			.mui-input-row .mui-input-speech~.mui-icon-speech {
				display: none !important;
			}
			
			.line {
				position: relative;
				display: none;
			}
			
			#imageWidth {
				margin: 0;
				width: 70px;
				height: 70px;
				background-position: left top;
				background-repeat: no-repeat;
				background-size: 100% 100%;
				display: block;
			}
			
			.deleteBtn {
				position: absolute;
				background-color: rgba(255, 0, 0, 0.8);
				text-align: center;
				width: 20px;
				height: 20px;
				border-radius: 40px;
				top: -10px;
				left: 56px;
				display: inherit;
			}
		</style>
	</head>

	<body>
		<header id="header_box" class="mui-bar mui-bar-nav">
			<div id="header_content">
				<div class="btn-box">
					<div id="btn-return" class="btn-return">取消</div>
					<div id="btn_send" class="btn-send">发送</div>
				</div>
			</div>
		</header>
		<div class="mui-content">
			<div class="mui-input-row">
				<textarea id="content_textarea" rows="5" placeholder="说出你的小秘密..."></textarea>
			</div>
			<!--<div id='image-list' class="row image-list" style="display: none;"></div>-->
			<div id="line" class="line">
				<img id="imageWidth" data-preview-src="" data-preview-group="1">
				<div class="deleteBtn">X</div>
				</img>
			</div>
			<div class="mui-input-row nav-footer">
				<input id='contact' maxlength="6" type="text" class="mui-input-clear contact" placeholder="添加1-6字的关键字" />
				<div class="function_btn">
					<a href="javascript:;" id="photo"><img src="../imgs/photo.png" /></a>
					<a href="javascript:;" id="picture"><img src="../imgs/picture.png" /></a>
					<a href="javascript:;" id="speak"><img src="../imgs/speak.png" /></a>
				</div>
			</div>
		</div>
		<script src="../js/mui.min.js"></script>
		<script src="../js/mui.zoom.js"></script>
		<script src="../js/mui.previewimage.js"></script>
		<!--<script type="text/javascript" src="../js/common.js"></script>-->
		<script type="text/javascript" src="../js/immersion.js"></script>
		<!--<script src=" ../js/feedback.js" type="text/javascript" charset="utf-8"></script>-->
		<script type="text/javascript" src="../js/photo.js"></script>
		<script type="text/javascript">
			mui.init({
				swipeBack: true, //Boolean(默认false)启用右滑关闭功能
			});
			var content_textarea = document.getElementById("content_textarea");
			document.getElementById('speak').addEventListener('tap', function() {
				startRecognize();
			})
			//语音翻译事件
			function startRecognize() {
				if(plus.os.name == 'Android' && navigator.userAgent.indexOf('StreamApp') > 0) {
					plus.nativeUI.toast('当前环境暂不支持语音识别插件');
					return;
				}
				var options = {};
				options.engine = 'iFly';
				options.punctuation = true; // 是否需要标点符号 
				content_textarea.value = "";
				console.log("开始语音识别：");
				plus.speech.startRecognize(options, function(s) {
					console.log(s);
					content_textarea.value += s;
				}, function(e) {
					outSet("语音识别失败：" + e.message);
				});
			};

			//			mui.plusReady(function () {
			//				plus.webview.currentWebview().setStyle({
			//				softinputMode: "adjustResize"
			//				});
			//			})

			//键盘弹出事件

			var nativeWebview, imm, InputMethodManager;
			var initNativeObjects = function() {
				if(mui.os.android) {
					var main = plus.android.runtimeMainActivity();
					var Context = plus.android.importClass("android.content.Context");
					InputMethodManager = plus.android.importClass("android.view.inputmethod.InputMethodManager");
					imm = main.getSystemService(Context.INPUT_METHOD_SERVICE);
				} else {
					nativeWebview = plus.webview.currentWebview().nativeInstanceObject();
				}
			};
			var showSoftInput = function() {
				var nativeWebview = plus.webview.currentWebview().nativeInstanceObject();
				if(mui.os.android) {
					//强制当前webview获得焦点
					plus.android.importClass(nativeWebview);
					nativeWebview.requestFocus();
					imm.toggleSoftInput(0, InputMethodManager.SHOW_FORCED);
				} else {
					nativeWebview.plusCallMethod({
						"setKeyboardDisplayRequiresUserAction": false
					});
				}
				setTimeout(function() {
					//此处可写具体逻辑设置获取焦点的input
					var inputElem = document.getElementById("content_textarea");
					inputElem.focus();
				}, 200);
			};
			mui.plusReady(function() {
				showSoftInput();
				initNativeObjects();

			});
		</script>
	</body>

</html>