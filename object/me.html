<!doctype html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<meta content="yes" name="apple-mobile-web-app-capable">
        <meta content="yes" name="apple-touch-fullscreen">
        <meta content="telephone=no,email=no" name="format-detection">
        <script type="text/javascript" src="../js/zoom/flexible.js" ></script>
        <script type="text/javascript" src="../js/zoom/flexible_css.js" ></script>
		<link href="../css/mui.min.css" rel="stylesheet" />
		<style>
		html,body{
			margin: 0;
			padding: 0;
			background-color: #EEEEEE;
		}
			.me-head{	
				margin: 0;
				padding: 0;
				width: 10rem;
				height: 9.072222rem;
				background-color: #FBD940;
				box-sizing: border-box;
				padding-top:1.208333rem;
			}
			
			.head-box{
				margin-left:1.791666rem;
				width: 6.416666rem;
				height: 6.416666rem;
				border-radius:200px;
				background-color: #EEEEEE;
			}
			.head-box img{
				width: 4.347222rem;
				height: 5.791666rem;
				margin-top: 0.166666rem;
				margin-left: 1.083333rem;
			}
			.head-title{
				font-size: 0.527777rem;
				color: #272727;
				margin-left: 4.247222rem;
				margin-top: 0.5rem;
				font-weight: bolder;
			}
			.me-message{
				margin-top: 0.402777rem;
				height: 3.166666rem;
				width: 10rem;
				display: flex;
			}
			.message{
				width: 4.95rem;
				height:3.166666rem;
				background: #FBD940;
				position: relative;
				border-right:0.05rem solid #EEEEEE;
			}
			.message img{
				width: 0.805555rem;
				height: 0.611111rem;
				position: absolute;
				top: 1.291666rem;
				left: 0.486111rem;
			}
			.message-title{
				position: absolute;
				top: 1.277777rem;
				left: 1.694444rem;
				font-size: 0.638888rem;
			}
			.attention{
				width: 5.05rem;
				height:3.166666rem;
				background: #FBD940;
				position: relative;
			}
			.attention img{
				width: 0.694444rem;
				height: 0.777777rem;
				position: absolute;
				top:1.111111rem;
				left:0.75rem;
			}
			.me-btn{
				margin-top: 0.402777rem;
			}
			#btn_return{
				border: none;
				background: #FBD940;
				font-size:0.638888rem;
				color: #272727;
				padding: 15px 0;
			}
		</style>
	</head>

	<body>
		<div class="me-head" id="head_box">
			<!--<div class="head-box" id="head_icon">
				<img src="../imgs/me/tree0_head.png" />
			</div>
			<div class="head-title" id="comment_message">
				子非鱼
			</div>-->
		</div>
		<div class="me-message">
			<div class="message" id="btn_message">
				<img src="../imgs/me/messagge.png" />
				<div class="message-title">我的消息</div>
			</div>
			<div class="attention" id="btn_attention">
				<img src="../imgs/me/medal.png" />
				<div class="message-title">我的关注</div>
			</div>
		</div>
		<div class="me-btn">
			<input type="button" id="btn_return" class="mui-btn mui-btn-block" value="登录/注册"></input>
		</div>
		<script src="../js/mui.min.js"></script>
		<script src="../js/template.js"></script>
		<script src="../js/immersion.js"></script>
		<script type="text/html" id="head_list">			
				<div class="head-box">
					<img src="../imgs/me/tree{{num}}_head.png" />
				</div>
				<div class="head-title" id="comment_message">
					{{title}}
				</div>
		</script>
		
		<script type="text/javascript">
		mui.init({
			swipeBack:true, //Boolean(默认false)启用右滑关闭功能
			  preloadPages:[{
				    url: '../login/login.html', 
					id:'login.html'
			    }]
			});
		mui.plusReady(function () {
			var token = plus.storage.getItem('name_token');
			var btn_message = document.getElementById("btn_message");
			var btn_attention = document.getElementById("btn_attention");
			var comment_message = document.getElementById("comment_message");
			var head_box = document.getElementById("head_box");
			var btn_return = document.getElementById("btn_return");
			if(!token){
				btn_return.value = '登录/注册';
			}else{
				btn_return.value = '退出登录';
			}
			//开启回弹
			plus.webview.currentWebview().setStyle({
					bounce: "vertical",
					bounceBackground:"#EEEEEE"
				});
			//更换头像
			var num;
			if(plus.storage.getItem("nowHead")){
				num = plus.storage.getItem("nowHead");
			}else{
				num = 0;
			}
			var nickname = ' ';
			console.log('这是未登录状态的头像'+num);
			console.log('这是未登录状态的名字'+nickname);
			artHead(num);
		
		
			btn_return.addEventListener('tap',function(){
				if(token){
					plus.storage.removeItem('name_token');
					btn_return.value = '登录/注册';
				}else{
					mui.openWindow({
					    url: '../login/login.html', 
					    id:'login.html'
					  });
				}
			});
			btn_message.addEventListener('tap',function(){
				if(token){
					mui.openWindow({
					    url: 'myMess.html', 
					    id:'myMess.html'
					  });
				}else{
					mui.openWindow({
					    url: '../login/login.html', 
					    id:'login.html'
					  });
				}

			});
			btn_attention.addEventListener('tap',function(){
				if(token){
				mui.openWindow({
			    url: 'myAttention.html', 
			    id:'myAttention.html'
			  });
			 }else{
					mui.openWindow({
					    url: '../login/login.html', 
					    id:'login.html'
					  });
				}
			})
			mui('#head_box').on('tap','.head-box',function(){
				if(token){
				mui.openWindow({
			    url: 'head_modification.html', 
			    id:'head_modification.html'
			  });
			 }else{
					mui.openWindow({
					    url: '../login/login.html', 
					    id:'login.html'
					  });
				}
			});
		
		window.addEventListener('headId',function(event){
		  //获得事件参数
		  num = event.detail.num;
		  nickname = event.detail.nickname;
		  plus.storage.setItem("nowHead",num);
		  artHead(num);
		});
		//修改头像
		function artHead(num){
			var data = {
				num:num,
				title:nickname
			}
			var html = template('head_list', data);
			document.getElementById('head_box').innerHTML = html;
		}
});
		</script>
	</body>

</html>